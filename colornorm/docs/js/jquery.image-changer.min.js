/*!
 * jquery-image-changer
 * author: tsuyoshiwada
 * version: 2.1.1
 * license: MIT
 * copyright: tsuyoshiwada
 */
!function(t,i){"use strict";"object"==typeof module&&"object"==typeof module.exports?i(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],i):i(t.jQuery)}(this,function(t){"use strict";function i(t,i,s){return Array.prototype.slice.call(t,i,void 0!==s?s:t.length)}function s(t){return!t||""===t||0===t}function n(t,i){return null!=t&&Object.prototype.hasOwnProperty.call(t,i)}function e(i){var s="string"===t.type(i)?i.split("|"):i.concat();return"\\."+s.join("|\\.")}function a(){return"string"===t.type(arguments[0])?a.callAPI.apply(this,arguments):void this._initialize.apply(this,arguments)}function o(i,s){v.builtin[i]=t.extend({},v.base,s)}function r(t){delete v.builtin[t]}function h(i,s,n){return s=s||p.suffix,n=n||_,"string"===t.type(i)&&i.match(new RegExp("^(.+)"+s+"("+n+")$","gi"))?!0:!1}function f(i,s,n){if(s=s||p.suffix,n=n||_,"string"===t.type(i))return h.apply(this,arguments)?i:i.replace(new RegExp("^(.+)("+n+")$","gi"),"$1"+s+"$2");if(i&&i.jquery){var e,a,o=[];return i.each(function(){e=t(this),e.is("img")?(a=f(e.attr("src"),s,n),e.attr("src",a),o.push(a)):o=o.concat(f(e.find("img"),s,n))}),o}return!1}function c(i,s,n){if(s=s||p.suffix,n=n||_,"string"===t.type(i))return h.apply(this,arguments)?i.replace(new RegExp("^(.+)("+s+")("+n+")$","gi"),"$1$3"):i;if(i&&i.jquery){var e,a,o=[];return i.each(function(){e=t(this),e.is("img")?(a=c(e.attr("src"),s,n),e.attr("src",a),o.push(a)):o=o.concat(c(e.find("img"),s,n))}),o}return!1}function l(i,s,n){if(s=s||p.suffix,n=n||_,"string"===t.type(i))return h.apply(this,arguments)?c.apply(this,arguments):f.apply(this,arguments);if(i&&i.jquery){var e,a,o=[];return i.each(function(){e=t(this),e.is("img")?(a=l(e.attr("src"),s,n),e.attr("src",a),o.push(a)):o=o.concat(l(e.find("img"),s,n))}),o}return!1}var u="2.1.1",p={suffix:"_on",hover:!0,transition:"fade",backgroundImage:!1,imageTypes:"jpg|jpeg|gif|png",beforeInit:!1,afterInit:!1,beforeChange:!1,afterChange:!1,beforeOnImage:!1,afterOnImage:!1,beforeOffImage:!1,afterOffImage:!1},g=t.map(p,function(t,i){return i}),m="ic",d={ROLL_OVER:"mouseenter."+m,ROLL_OUT:"mouseleave."+m,CLICK:"click."+m},$={TOUCH_START:"touchstart."+m,TOUCH_END:"touchend."+m,TOUCH_MOVE:"touchmove."+m},y={image:m+"-image",inner:m+"-inner",on:m+"-on",off:m+"-off"},b="ontouchstart"in window,v={builtin:{},base:{defaults:{duration:150,easing:"linear",opacity:0},initialize:function(t){this.status.startOn||this.$on.css("opacity",0)},on:function(t,i){this.$on.css("opacity",1),this.$off.css("opacity",0),i()},off:function(t,i){this.$on.css("opacity",0),this.$off.css("opacity",1),i()},destroy:function(){}}};a.fn=a.prototype,a.fn._initialize=function(i,n){if(this.version=u,this.options=null,this.transition=null,this.imageTypes="",this.$elem=null,this.$img=null,this.$parant=null,this.$on=null,this.$off=null,this.status={startOn:!1,active:!1,animate:!1,enable:!1,loaded:!1,error:!1},this.touchTimer=!1,this.on="",this.off="",this.$elem=i,this.options=n,this._callbackApply("beforeInit",n.beforeInit)===!1)return!1;this.$img=i.find("img"),this.$parent=this.$img.parent(),this.transition=this._getTransition(),this.imageTypes=e(n.imageTypes);var a="";if(n.backgroundImage?(a=this.$elem.css("background-image")||"",a=a.match(/url\((\S+)\)/)?RegExp.$1:"",a=a.replace(/"/g,"")):a=this.$img.attr("src"),s(a))return!1;var o=this._hasSuffix(a);o?(this.on=a,this.off=this._removeSuffix(a),this.status.active=this.status.startOn=!0):(this.on=this._addSuffix(a),this.off=a),this._buildHtml(),t("<img>").on("load",t.proxy(this._loadSuccess,this)).on("error",t.proxy(this._loadError,this)).attr("src",o?this.off:this.on)},a.fn._buildHtml=function(){var i,s,n,e,a,o=this.$elem,r=o.html(),h={width:o.width(),height:o.height()};if(this.options.backgroundImage===!0){var f={position:"absolute",zIndex:1,top:0,left:0,display:"inline-block",width:h.width,height:h.height};a=o.css("position"),a="static"!=a?a:"relative",f.zIndex=3,i=t("<span>").addClass(y.inner).css(f).html(r),f.zIndex=2,f.backgroundImage="url("+this.off+")",n=t("<span>").addClass(y.off).css(f),f.zIndex=1,f.backgroundImage="url("+this.on+")",e=t("<span>").addClass(y.on).css(f),o.css({"background-image":"transparent",position:a}).append(i).append(n).append(e)}else{var c={position:"absolute",zIndex:1},l={};n=this.$img,a=n.css("position"),e=t(t("<div>").append(n.clone()).html()).addClass(y.on).attr("src",this.on),n.wrap('<span class="'+y.image+'" style="position:relative; display:inline-block; /display:inline;"></span>'),s=this.$elem.find(y.image),"static"===a?(l.position="relative",c.top=0,c.left=0):(c.top=n.css("top"),c.right=n.css("right"),c.bottom=n.css("bottom"),c.left=n.css("left")),e.css(c),n.css(l),n.css("z-index",2).addClass(y.off),this.$elem.find("."+y.image).append(e)}this.$on=e,this.$off=n,this.$inner=i,this.$image=s,this.status.active&&this.$off.attr("src",this.off).css("opacity",0)},a.fn._unbuildHtml=function(){if(this.options.backgroundImage===!0)this.$elem.css({"background-image":"",position:""}),this.$inner.remove(),this.$on.remove(),this.$off.remove();else{var t=this.status.startOn?this.$off:this.$on,i=this.status.startOn?this.$on:this.$off;this.$img.unwrap(),t.remove(),i.css({position:"","z-index":""}).removeClass(y.off)}},a.fn._loadSuccess=function(){this.status.enable=this.status.loaded=!0,this._bindEvents(),this.transition.initialize.call(this,t.extend(!0,{},this.transition.defaults,this.options.transition)),this._callbackApply("afterInit",this.options.afterInit,"success")},a.fn._loadError=function(){this.status.error=!0,this._callbackApply("afterInit",this.options.afterInit,"error")},a.fn._bindEvents=function(){this.options.hover===!0&&(b?this.$elem.on($.TOUCH_START,t.proxy(this._onTouchStartHandler,this)).on($.TOUCH_END,t.proxy(this._onTouchEndHandler,this)).on($.TOUCH_MOVE,t.proxy(this._onTouchMoveHandler,this)):this.$elem.on(d.ROLL_OVER,t.proxy(this._onRollOverHandler,this)).on(d.ROLL_OUT,t.proxy(this._onRollOutHandler,this)))},a.fn._unbindEvents=function(){this.options.hover===!0&&(b?this.$elem.off($.TOUCH_START).off($.TOUCH_END).off($.TOUCH_MOVE):this.$elem.off(d.ROLL_OVER).off(d.ROLL_OUT))},a.fn._onRollOverHandler=function(){this.onImage()},a.fn._onRollOutHandler=function(){this.offImage()},a.fn._onTouchStartHandler=function(){this.onImage()},a.fn._onTouchEndHandler=function(){this.offImage()},a.fn._onTouchMoveHandler=function(){this.touchTimer&&clearTimeout(this.touchTimer),this.touchTimer=setTimeout(t.proxy(this.offImage,this),200)},a.fn._callbackApply=function(){var s=arguments[0],n=arguments[1],e=i(arguments,2),a=t.isFunction(n)?n:function(){},o=a.apply(this,e),r=new t.Event(m+"."+s);return r.target=this.$elem,this.$elem.trigger(r,this),o},a.fn._hasSuffix=function(t){return h(t,this.options.suffix,this.imageTypes)},a.fn._addSuffix=function(t){return f(t,this.options.suffix,this.imageTypes)},a.fn._removeSuffix=function(t){return c(t,this.options.suffix,this.imageTypes)},a.fn._transition=function(i,s){var n=this,e=t.extend({},n.transition.defaults,n.options.transition||{});n.transition[i].call(n,e,function(){s.call(n)})},a.fn._getTransition=function(){var i=v.builtin,s=v.base,e=this.options.transition,a=e?e.type:"";if(e===!1||"none"===e||"default"===e)return t.extend(!0,{},s);if(n(i,e))return i[e];if(n(i,a))return i[a];if("custom"===a)return t.extend(!0,{},s,e);throw new Error("[ImageChanger] :: Is invalid specification of transition.")},a.fn.isChangeEnable=function(){return!this.status.error&&this.status.enable},a.fn.toggle=function(t){this.status.active?this.offImage(t):this.onImage(t)},a.fn.onImage=function(i){return!this.isChangeEnable()||this.status.active?!1:this._callbackApply("beforeChange",this.options.beforeChange,"on")===!1?!1:this._callbackApply("beforeOnImage",this.options.beforeOnImage)===!1?!1:(this.status.active=!0,this.status.animate=!0,void this._transition("on",function(){this.status.animate=!1,this._callbackApply("afterChange",this.options.afterChange,"on"),this._callbackApply("afterOnImage",this.options.afterOnImage),t.isFunction(i)&&i.call(this)}))},a.fn.offImage=function(i){return this.isChangeEnable()&&this.status.active?this._callbackApply("beforeChange",this.options.beforeChange,"off")===!1?!1:this._callbackApply("beforeOffImage",this.options.beforeOffImage)===!1?!1:(this.status.active=!1,this.status.animate=!0,void this._transition("off",function(){this.status.animate=!1,this._callbackApply("afterChange",this.options.afterChange,"off"),this._callbackApply("afterOffImage",this.options.afterOffImage),t.isFunction(i)&&i.call(this)})):!1},a.fn.disable=function(){this.status.enable=!1},a.fn.enable=function(){this.status.error||(this.status.enable=!0)},a.fn.destroy=function(){return this.$elem.data("imageChanger")?(this.transition.destroy.call(this),this._unbindEvents(),this._unbuildHtml(),this.status.enable=!1,void this.$elem.removeData("imageChanger")):!1};var _=e(p.imageTypes);a.callAPI=function(){var t=arguments[0],s=i(arguments,1);switch(t){case"addSuffix":return f.apply(this,s);case"removeSuffix":return c.apply(this,s);case"toggleSuffix":return l.apply(this,s);case"registerTransition":return o.apply(this,s);case"unregisterTransition":return r.apply(this,s);default:throw new Error("[ImageChanger] :: Is invalid specification of Global API.")}},a.registerTransition=function(){o.apply(this,arguments)},a.unregisterTransition=function(){r.apply(this,arguments)},o("fade",{initialize:function(t){this.status.startOn||this.$on.css("opacity",0)},on:function(t,i){var s=t.duration,n=t.easing;this.$on.css("opacity",1),this.$off.stop().animate({opacity:t.opacity},s,n,i)},off:function(t,i){var s=t.duration,n=t.easing;this.$on.stop().animate({opacity:1},s/2,n),this.$off.stop().animate({opacity:1},s,n,i)},destroy:function(){this.$off.stop(!0,!0).css("opacity",""),this.$on.stop(!0,!0).css("opacity","")}}),o("wink",{defaults:{duration:150,easing:"swing",opacity:.4},initialize:function(t){this.status.startOn&&this.$on.css("opacity",0)},on:function(t,i){if(this.$off.is(":animated"))return i();var s=t.duration,n=t.easing;this.$on.stop().animate({opacity:1},s,n).animate({opacity:0},s,n),this.$off.stop().animate({opacity:t.opacity},s,n).animate({opacity:1},s,n,i)},off:function(t,i){t=t,i()},destroy:function(){this.$on.stop(!0,!0).css("opacity",""),this.$off.stop(!0,!0).css("opacity","")}}),o("slide",{defaults:{duration:150,easing:"swing",direction:"top",display:"inline-block"},initialize:function(t){var i="static"===this.$elem.css("position")?"relative":this.$elem.css("position"),s="inline"===this.$elem.css("display")?t.display:this.$elem.css("display");this.$elem.css({position:i,overflow:"hidden",display:s});var n={width:this.$elem.width(),height:this.$elem.height()};switch(t.direction){case"top":this.$off.css({top:0}),this.$on.css({top:n.height});break;case"right":this.$off.css({left:0}),this.$on.css({left:-n.width});break;case"bottom":this.$off.css({top:0}),this.$on.css({top:-n.height});break;case"left":this.$off.css({left:0}),this.$on.css({left:n.width})}},on:function(t,i){var s={width:this.$elem.width(),height:this.$elem.height()},n=t.duration,e=t.easing;switch(this.$off.stop(),this.$on.stop(),t.direction){case"top":this.$off.animate({top:-s.height},n,e),this.$on.animate({top:0},n,e,i);break;case"right":this.$off.animate({left:s.width},n,e),this.$on.animate({left:0},n,e,i);break;case"bottom":this.$off.animate({top:s.height},n,e),this.$on.animate({top:0},n,e,i);break;case"left":this.$off.animate({left:-s.width},n,e),this.$on.animate({left:0},n,e,i)}},off:function(t,i){var s={width:this.$elem.width(),height:this.$elem.height()},n=t.duration,e=t.easing;switch(this.$off.stop(),this.$on.stop(),t.direction){case"top":this.$off.animate({top:0},n,e),this.$on.animate({top:s.height},n,e,i);break;case"right":this.$off.animate({left:0},n,e),this.$on.animate({left:-s.width},n,e,i);break;case"bottom":this.$off.animate({top:0},n,e),this.$on.animate({top:-s.height},n,e,i);break;case"left":this.$off.animate({left:0},n,e),this.$on.animate({left:s.width},n,e,i)}},destroy:function(){var t={top:"",right:"",bottom:"",left:""};this.$off.stop(!0,!0).css(t),this.$on.stop(!0,!0).css(t),this.$elem.css({position:"",overflow:"",display:""})}}),t.imageChanger=t.imageChanger||a,t.fn.imageChanger=function(i){return this.each(function(){var s,n=t(this),e={};n.data("imageChanger")||(t.each(g,function(i,a){s=n.data(t.camelCase(m+"-"+a.toLowerCase())),void 0!==s&&(e[a]=s)}),n.data("imageChanger",new a(n,t.extend(!0,{},p,i,e))))})}});